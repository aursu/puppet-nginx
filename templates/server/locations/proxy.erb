<%-
def bool2config(b)
    case b
    when true
        'on'
    when false, nil
        'off'
    else
        b.to_s
    end
end
-%>
<% if @proxy_read_timeout -%>
    proxy_read_timeout <%= @proxy_read_timeout %>;
<% end -%>
<% if @proxy_connect_timeout -%>
    proxy_connect_timeout <%= @proxy_connect_timeout %>;
<% end -%>
<% if @proxy_send_timeout -%>
    proxy_send_timeout <%= @proxy_send_timeout %>;
<% end -%>
<% if @proxy_redirect -%>
    proxy_redirect <%= @proxy_redirect %>;
<% end -%>
<% if @proxy_http_version -%>
    proxy_http_version <%= @proxy_http_version %>;
<% end -%>
<% if @proxy_method -%>
    proxy_method <%= @proxy_method %>;
<% end -%>
<% if @proxy_set_body -%>
    proxy_set_body <%= @proxy_set_body %>;
<% end -%>
<% unless @proxy_buffering.nil? -%>
    proxy_buffering <%= bool2config(@proxy_buffering) %>;
<% end -%>
<% if @proxy_buffer_size -%>
    proxy_buffer_size <%= @proxy_buffer_size %>;
<% end -%>
<% if @proxy_buffers -%>
    proxy_buffers <%= @proxy_buffers %>;
<% end -%>
<% if @proxy_request_buffering -%>
    proxy_request_buffering <%= @proxy_request_buffering %>;
<% end -%>
<% if @proxy_busy_buffers_size -%>
    proxy_busy_buffers_size <%= @proxy_busy_buffers_size %>;
<% end -%>
<% if @proxy_max_temp_file_size -%>
    proxy_max_temp_file_size <%= @proxy_max_temp_file_size %>;
<% end -%>
<% if @proxy_request_buffering -%>
    proxy_request_buffering <%= @proxy_request_buffering %>;
<% end -%>
<% if @proxy_set_header.is_a?(Array) -%>
    <%- @proxy_set_header.each do |header| -%>
    proxy_set_header <%= header %>;
    <%- end -%>
<% end -%>
<% if @proxy_hide_header.is_a?(Array) -%>
    <%- @proxy_hide_header.each do |header| -%>
    proxy_hide_header <%= header %>;
    <%- end -%>
<% end -%>
<% if @proxy_ignore_header.is_a?(Array) -%>
    <%- @proxy_ignore_header.each do |header| -%>
    proxy_ignore_headers <%= header %>;
    <%- end -%>
<% end -%>
<% if @proxy_pass_header.is_a?(Array) -%>
    <%- @proxy_pass_header.each do |header| -%>
    proxy_pass_header <%= header %>;
    <%- end -%>
<% end -%>
<% if @proxy_cache -%>
    proxy_cache <%= @proxy_cache %>;
<% end -%>
<% if @proxy_cache_valid -%>
    <%- Array(@proxy_cache_valid).each do |line| -%>
    proxy_cache_valid <%= line %>;
    <%- end -%>
<% end -%>
<% if @proxy_cache_use_stale -%>
    proxy_cache_use_stale <%= @proxy_cache_use_stale %>;
<% end -%>
<% if @proxy_cache_key -%>
    proxy_cache_key <%= @proxy_cache_key %>;
<% end -%>
<% if @proxy_cache_bypass -%>
  <%- Array(@proxy_cache_bypass).each do |line| -%>
    proxy_cache_bypass <%= line %>;
  <% end -%>
<% end -%>
<% unless @proxy_cache_lock.nil? -%>
    proxy_cache_lock <%= bool2config(@proxy_cache_lock) %>;
<% end -%>
<% if @proxy_next_upstream -%>
    proxy_next_upstream <%= @proxy_next_upstream %>;
<% end -%>
<% unless @proxy_cache_revalidate.nil? -%>
    proxy_cache_revalidate <%= bool2config(@proxy_cache_revalidate) %>;
<% end -%>
<% unless @proxy_cookie_domain.nil? -%>
<%   if @proxy_cookie_domain.is_a?(Hash) -%>
<%-    @proxy_cookie_domain.each do |domain, replacement| -%>
    proxy_cookie_domain <%= domain %> <%= replacement %>;
<%     end -%>
<%   else -%>
    proxy_cookie_domain off;
<%   end -%>
<% end -%>